<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>NFT Editor ‚Üí GitHub Commit</title>
    <style>
      body {
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        padding: 24px;
        background: #0f172a;
        color: #e6eef8;
      }
      .card {
        background: rgba(255, 255, 255, 0.03);
        padding: 16px;
        border-radius: 12px;
        max-width: 40rem;
        margin: auto;
      }
      canvas {
        display: block;
        margin: 12px 0;
        border-radius: 8px;
        background: linear-gradient(135deg, #0ea5a4, #7c3aed);
        max-width: 100%;
      }
      label {
        display: block;
        margin-top: 8px;
        font-size: 11px;
        color: #cbd5e193;
      }
      input,
      select,
      button,
      textarea {
        width: 100%;
        padding: 8px 10px;
        margin-top: 6px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: rgba(255, 255, 255, 0.02);
        color: inherit;
        box-sizing: border-box;
        outline: none;
      }
      button {
        cursor: pointer;
      }
      .row {
        display: flex;
        gap: 12px;
        margin-bottom: 12px;
      }
      .row > * {
        flex: 1;
        min-width: 0;
      }
      .muted {
        font-size: 12px;
        color: #9fb0c8;
        margin-top: 8px;
      }
      .small {
        font-size: 12px;
        color: #9fb0c8;
      }
      .success {
        color: #9ee6a3;
      }
      .error {
        color: #ffb4b4;
      }
      .canvas-container {
        position: relative;
        display: inline-block;
        max-width: 100%;
      }
      .tabs {
        display: flex;
        margin-bottom: 20px;
      }
      .tab-button {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: inherit;
        padding: 5px 10px;
        border-radius: 8px;
        cursor: pointer;
        margin-right: 10px;
      }
      .tab-button.active {
        background: rgba(255, 255, 255, 0.1);
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .dropdown {
        position: relative;
        display: flex;
        gap: 1px;
      }
      .download-main-btn {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-right: none;
        color: inherit;
        padding: 8px 16px;
        border-radius: 8px 0 0 8px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
        width: auto;
      }
      .download-main-btn:hover {
        background: rgba(255, 255, 255, 0.05);
      }
      .dropdown-trigger {
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-left: none;
        color: inherit;
        padding: 8px 10px;
        border-radius: 0 8px 8px 0;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
        width: auto;
        min-width: 32px;
      }
      .dropdown-trigger:hover {
        background: rgba(255, 255, 255, 0.05);
      }
      .dropdown-arrow {
        width: 0;
        height: 0;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        border-top: 5px solid currentColor;
        transition: transform 0.2s;
      }
      .dropdown.open .dropdown-arrow {
        transform: rotate(180deg);
      }
      .dropdown-menu {
        position: absolute;
        top: calc(100% + 4px);
        left: 0;
        background: rgba(30, 41, 59, 0.98);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 4px;
        min-width: 140px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-8px);
        transition: all 0.2s;
        z-index: 1000;
      }
      .dropdown.open .dropdown-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
      .dropdown-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
        color: #e6eef8;
        transition: background 0.15s;
        white-space: nowrap;
      }
      .dropdown-item:hover {
        background: rgba(255, 255, 255, 0.08);
      }
      .dropdown-item-icon {
        font-size: 12px;
        opacity: 0.7;
      }
      .button-group {
        display: flex;
        gap: 10px;
        margin-top: 12px;
      }
      .button-group > * {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
        "
      >
        <h2>NFT Editor ‚Üí GitHub</h2>

        <div class="tabs">
          <button class="tab-button active" data-tab="preview">Panel</button>
          <button class="tab-button" data-tab="list">List</button>
        </div>
      </div>

      <div class="row">
        <div style="flex: 0 0 calc(50% - 8px)">
          <label>Token (PAT)</label>
          <input id="token" placeholder="ghp_xxx..." />
        </div>
        <div style="flex: 0 0 calc(20% - 8px)">
          <label>Owner</label>
          <input id="owner" placeholder="username or org" />
        </div>
        <div style="flex: 0 0 calc(30% - 8px)">
          <label>Repo</label>
          <input id="repo" placeholder="repository" />
        </div>
      </div>

      <div class="tab-content active" id="preview-tab">
        <div class="row">
          <div style="flex: 0 0 calc(20% - 8px)">
            <label>Branch</label>
            <input id="branch" placeholder="main" value="main" />
          </div>
          <div style="flex: 0 0 calc(25% - 8px)">
            <label>Folder path (where to save)</label>
            <input id="pathPrefix" placeholder="nfts" value="nfts" />
          </div>
          <div style="flex: 0 0 calc(55% - 8px)">
            <label>Title</label>
            <input id="title" placeholder="My awesome NFT" value="My NFT" />
          </div>
        </div>

        <div class="row">
          <div style="flex: 1">
            <label>Description</label>
            <input
              id="desc"
              placeholder="M·ªôt NFT ƒë·∫πp t·ª´ GitHub Pages"
              value="Generated from GitHub Pages NFT Editor"
            />
          </div>
        </div>

        <div class="canvas-container">
          <canvas id="canvas" width="2048" height="1152"></canvas>
          <span
            id="expand-icon"
            style="
              position: absolute;
              top: 10px;
              right: 10px;
              color: white;
              font-size: 24px;
              cursor: pointer;
            "
            >üîç</span
          >
        </div>

        <div class="button-group">
          <button
            id="preview"
            type="button"
            style="
              background: rgba(255, 255, 255, 0.02);
              border: 1px solid rgba(255, 255, 255, 0.06);
              color: inherit;
              padding: 8px 12px;
              border-radius: 8px;
              cursor: pointer;
            "
          >
            Re-generate
          </button>

          <div class="dropdown" id="download-dropdown">
            <button
              class="download-main-btn"
              id="download-btn"
              type="button"
              data-current-format="png"
            >
              Export as PNG
            </button>
            <button class="dropdown-trigger" type="button">
              <div class="dropdown-arrow"></div>
            </button>
            <div class="dropdown-menu">
              <div class="dropdown-item" data-format="png">
                <span class="dropdown-item-icon">üìÑ</span>
                <span>Save PNG</span>
              </div>
              <div class="dropdown-item" data-format="jpg">
                <span class="dropdown-item-icon">üì∑</span>
                <span>Save JPG</span>
              </div>
              <div class="dropdown-item" data-format="svg">
                <span class="dropdown-item-icon">üé®</span>
                <span>Save SVG</span>
              </div>
              <div class="dropdown-item" data-format="avif">
                <span class="dropdown-item-icon">üñºÔ∏è</span>
                <span>Save AVIF</span>
              </div>
              <div class="dropdown-item" data-format="webp">
                <span class="dropdown-item-icon">üåê</span>
                <span>Save WEBP</span>
              </div>
            </div>
          </div>

          <button id="generate">Mint</button>
        </div>

        <div class="small muted">
          <div id="status"></div>
          <pre id="log"></pre>
        </div>
      </div>

      <div class="tab-content" id="list-tab">
        <button id="list" type="button">List NFTs</button>
        <div id="nft-list" style="margin-top: 20px"></div>
      </div>
    </div>

    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d", { alpha: true });
      const logEl = document.getElementById("log");
      const statusEl = document.getElementById("status");

      function log(...args) {
        logEl.textContent +=
          args
            .map((a) =>
              typeof a === "object" ? JSON.stringify(a, null, 2) : String(a)
            )
            .join(" ") + "\\n";
        logEl.scrollTop = 1e9;
      }

      // Simple generator: gradient + shapes + random text + timestamp
      function drawNFT(title = "My NFT") {
        const w = canvas.width,
          h = canvas.height;
        // background gradient
        const g = ctx.createLinearGradient(0, 0, w, h);
        const a = Math.floor(Math.random() * 360);
        g.addColorStop(0, `hsl(${a}deg 70% 45% / 1)`);
        g.addColorStop(1, `hsl(${(a + 60) % 360}deg 70% 55% / 0.9)`);
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, w, h);

        // random blob shapes
        for (let i = 0; i < 6; i++) {
          ctx.beginPath();
          ctx.globalAlpha = 0.12 + Math.random() * 0.25;
          ctx.fillStyle = `hsl(${(a + i * 30) % 360}deg 80% 50%)`;
          const cx = Math.random() * w;
          const cy = Math.random() * h;
          const rx = 120 + Math.random() * 520;
          const ry = 120 + Math.random() * 520;
          ctx.ellipse(cx, cy, rx, ry, Math.random() * Math.PI, 0, Math.PI * 2);
          ctx.fill();
        }

        // decorative circles
        ctx.globalAlpha = 0.35;
        for (let i = 0; i < 20; i++) {
          ctx.beginPath();
          const r = 8 + Math.random() * 120;
          ctx.fillStyle = `hsla(${(a + i * 7) % 360}deg,60%,55%,0.6)`;
          ctx.arc(Math.random() * w, Math.random() * h, r, 0, Math.PI * 2);
          ctx.fill();
        }

        // center rounded panel
        ctx.globalAlpha = 0.9;
        ctx.fillStyle = "rgba(255,255,255,0.06)";
        const pad = 96;
        roundRect(ctx, pad, pad, w - 2 * pad, h - 2 * pad, 40);
        ctx.fill();

        // title text
        ctx.fillStyle = "white";
        ctx.globalAlpha = 1;
        ctx.textAlign = "center";
        ctx.font = "bold 56px system-ui, Inter, Roboto, Arial";
        ctx.fillText(title, w / 2, h * 0.85);

        // small author / timestamp
        ctx.font = "20px system-ui, Inter";
        ctx.fillStyle = "rgba(255,255,255,0.85)";
        const ts = new Date().toISOString();
        ctx.fillText("by GitHub Pages ‚Ä¢ " + ts, w / 2, h * 0.9);
      }

      function roundRect(ctx, x, y, w, h, r) {
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.arcTo(x + w, y, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x, y + h, r);
        ctx.arcTo(x, y + h, x, y, r);
        ctx.arcTo(x, y, x + w, y, r);
        ctx.closePath();
      }

      let isExpanded = false;
      document.getElementById("expand-icon").addEventListener("click", () => {
        if (isExpanded) {
          canvas.style.width = "256px";
          canvas.style.height = "144px";
          document.getElementById("expand-icon").textContent = "üîç";
          isExpanded = false;
        } else {
          canvas.style.width = "512px";
          canvas.style.height = "288px";
          document.getElementById("expand-icon").textContent = "‚úñ";
          isExpanded = true;
        }
      });

      document.getElementById("preview").addEventListener("click", () => {
        drawNFT(document.getElementById("title").value || "My NFT");
        statusEl.textContent = "Preview drawn.";
      });

      // Download functionality
      function downloadFile(dataUrl, filename) {
        const link = document.createElement("a");
        link.download = filename;
        link.href = dataUrl;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }

      function downloadCanvas(format) {
        const title = document.getElementById("title").value.trim() || "My_NFT";
        const fileName = `${title.replace(/[^a-z0-9\-]/gi, "_")}_${Date.now()}`;

        try {
          let dataUrl;

          switch (format) {
            case "png":
              dataUrl = canvas.toDataURL("image/png");
              downloadFile(dataUrl, `${fileName}.png`);
              statusEl.textContent = "Downloaded as PNG";
              break;

            case "jpg":
              dataUrl = canvas.toDataURL("image/jpeg", 0.95);
              downloadFile(dataUrl, `${fileName}.jpg`);
              statusEl.textContent = "Downloaded as JPG";
              break;

            case "webp":
              dataUrl = canvas.toDataURL("image/webp", 0.95);
              downloadFile(dataUrl, `${fileName}.webp`);
              statusEl.textContent = "Downloaded as WEBP";
              break;

            case "avif":
              try {
                dataUrl = canvas.toDataURL("image/avif", 0.95);
                downloadFile(dataUrl, `${fileName}.avif`);
                statusEl.textContent = "Downloaded as AVIF";
              } catch (err) {
                statusEl.textContent =
                  "AVIF not supported - downloading as PNG instead";
                dataUrl = canvas.toDataURL("image/png");
                downloadFile(dataUrl, `${fileName}.png`);
              }
              break;

            case "svg":
              const pngData = canvas.toDataURL("image/png");
              const svgContent = `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     width="${canvas.width}" height="${canvas.height}" viewBox="0 0 ${canvas.width} ${canvas.height}">
  <image width="${canvas.width}" height="${canvas.height}" xlink:href="${pngData}"/>
</svg>`;
              const svgBlob = new Blob([svgContent], { type: "image/svg+xml" });
              const svgUrl = URL.createObjectURL(svgBlob);
              downloadFile(svgUrl, `${fileName}.svg`);
              setTimeout(() => URL.revokeObjectURL(svgUrl), 100);
              statusEl.textContent = "Downloaded as SVG";
              break;
          }

          statusEl.className = "small success";
        } catch (err) {
          console.error("Download error:", err);
          statusEl.textContent = "Download failed: " + err.message;
          statusEl.className = "small error";
        }
      }

      // Main download button - uses current format
      const downloadBtn = document.getElementById("download-btn");
      downloadBtn.addEventListener("click", () => {
        const currentFormat = downloadBtn.dataset.currentFormat || "png";
        downloadCanvas(currentFormat);
      });

      // Download dropdown functionality
      const dropdown = document.getElementById("download-dropdown");
      const dropdownTrigger = dropdown.querySelector(".dropdown-trigger");
      const dropdownItems = dropdown.querySelectorAll(".dropdown-item");

      dropdownTrigger.addEventListener("click", (e) => {
        e.stopPropagation();
        dropdown.classList.toggle("open");
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", (e) => {
        if (!dropdown.contains(e.target)) {
          dropdown.classList.remove("open");
        }
      });

      // Dropdown menu items
      dropdownItems.forEach((item) => {
        item.addEventListener("click", () => {
          const format = item.dataset.format;
          dropdown.classList.remove("open");

          // Update button text and current format
          downloadBtn.textContent = `Export as ${format.toUpperCase()}`;
          downloadBtn.dataset.currentFormat = format;

          downloadCanvas(format);
        });
      });

      document
        .getElementById("generate")
        .addEventListener("click", async () => {
          try {
            log("--- Starting generation ---");
            const token = document.getElementById("token").value.trim();
            const owner = document.getElementById("owner").value.trim();
            const repo = document.getElementById("repo").value.trim();
            const branch =
              document.getElementById("branch").value.trim() || "main";
            const pathPrefix =
              document.getElementById("pathPrefix").value.trim() || "nfts";
            const title =
              document.getElementById("title").value.trim() || "My NFT";
            const desc = document.getElementById("desc").value.trim() || "";

            if (!token || !owner || !repo) {
              statusEl.textContent = "Ch∆∞a nh·∫≠p token/owner/repo";
              statusEl.className = "small error";
              return;
            }

            // draw
            drawNFT(title);
            statusEl.textContent = "Canvas generated. Preparing upload...";
            statusEl.className = "small";

            // convert to base64 (dataURL)
            const dataUrl = canvas.toDataURL("image/png");
            const base64 = dataUrl.split(",")[1];

            // filename unique
            const ts = Date.now();
            const imagePath = `${pathPrefix}/${title.replace(
              /[^a-z0-9\-]/gi,
              "_"
            )}_${ts}.png`;
            const metaPath = `${pathPrefix}/${title.replace(
              /[^a-z0-9\-]/gi,
              "_"
            )}_${ts}.json`;

            // create image file (PUT to contents)
            log("Uploading image to", `${owner}/${repo}/${imagePath}`);
            await createFileOnGithub({
              token,
              owner,
              repo,
              branch,
              path: imagePath,
              contentBase64: base64,
              message: `Add NFT image ${imagePath}`,
            });

            // raw URL for image
            const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${encodeURIComponent(
              imagePath
            )}`;

            // metadata
            const metadata = {
              name: title,
              description: desc,
              image: rawUrl,
              created_at: new Date().toISOString(),
            };
            const metadataBase64 = btoa(
              unescape(encodeURIComponent(JSON.stringify(metadata, null, 2)))
            );

            log("Uploading metadata to", `${owner}/${repo}/${metaPath}`);
            await createFileOnGithub({
              token,
              owner,
              repo,
              branch,
              path: metaPath,
              contentBase64: metadataBase64,
              message: `Add NFT metadata ${metaPath}`,
            });

            statusEl.textContent = "Done ‚Äî image + metadata pushed.";
            statusEl.className = "small success";
            log("All done. Image:", rawUrl);
          } catch (err) {
            console.error(err);
            statusEl.textContent = "Error: " + (err.message || err);
            statusEl.className = "small error";
            log("ERROR:", err);
          }
        });

      document.getElementById("list").addEventListener("click", async () => {
        try {
          log("--- Listing NFTs ---");
          const token = document.getElementById("token").value.trim();
          const owner = document.getElementById("owner").value.trim();
          const repo = document.getElementById("repo").value.trim();
          const branch =
            document.getElementById("branch").value.trim() || "main";
          const pathPrefix =
            document.getElementById("pathPrefix").value.trim() || "nfts";

          if (!token || !owner || !repo) {
            statusEl.textContent = "Ch∆∞a nh·∫≠p token/owner/repo";
            statusEl.className = "small error";
            return;
          }

          const listEl = document.getElementById("nft-list");
          listEl.innerHTML = "<p>Loading...</p>";

          const url = `https://api.github.com/repos/${encodeURIComponent(
            owner
          )}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(
            pathPrefix
          )}?ref=${encodeURIComponent(branch)}`;
          const res = await fetch(url, {
            headers: {
              Authorization: "token " + token,
              Accept: "application/vnd.github+json",
            },
          });

          if (!res.ok) {
            throw new Error(
              `GitHub API error ${res.status}: ${res.statusText}`
            );
          }

          const files = await res.json();
          const jsonFiles = files.filter((f) => f.name.endsWith(".json"));

          if (jsonFiles.length === 0) {
            listEl.innerHTML = "<p>No NFTs found.</p>";
            return;
          }

          listEl.innerHTML = "<h3>Minted NFTs:</h3><ul></ul>";
          const ul = listEl.querySelector("ul");

          for (const file of jsonFiles) {
            const metaRes = await fetch(file.download_url);
            const metadata = await metaRes.json();

            const li = document.createElement("li");
            li.style.marginBottom = "10px";
            li.innerHTML = `
              <strong>${metadata.name}</strong><br>
              ${metadata.description}<br>
              <img src="${metadata.image}" style="width: 100px; height: 100px; object-fit: cover;"><br>
              Created: ${metadata.created_at}<br>
              <button class="remove-btn" data-sha="${file.sha}" data-path="${file.path}">Remove</button>
            `;
            ul.appendChild(li);
          }

          // Add event listeners to remove buttons
          document.querySelectorAll(".remove-btn").forEach((btn) => {
            btn.addEventListener("click", async (e) => {
              const metaPath = e.target.dataset.path;
              const metaSha = e.target.dataset.sha;
              const imagePath = metaPath.replace(".json", ".png");
              if (confirm(`Remove NFT: ${metaPath} and ${imagePath}?`)) {
                try {
                  // Get SHA for image file
                  const imageUrl = `https://api.github.com/repos/${encodeURIComponent(
                    owner
                  )}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(
                    imagePath
                  )}?ref=${encodeURIComponent(branch)}`;
                  const imageRes = await fetch(imageUrl, {
                    headers: {
                      Authorization: "token " + token,
                      Accept: "application/vnd.github+json",
                    },
                  });
                  if (!imageRes.ok) {
                    throw new Error(
                      `Failed to get image SHA: ${imageRes.status}`
                    );
                  }
                  const imageData = await imageRes.json();
                  const imageSha = imageData.sha;

                  // Delete metadata
                  await deleteFileOnGithub({
                    token,
                    owner,
                    repo,
                    branch,
                    path: metaPath,
                    sha: metaSha,
                    message: `Remove NFT metadata ${metaPath}`,
                  });
                  // Delete image
                  await deleteFileOnGithub({
                    token,
                    owner,
                    repo,
                    branch,
                    path: imagePath,
                    sha: imageSha,
                    message: `Remove NFT image ${imagePath}`,
                  });

                  log(`Removed ${metaPath} and ${imagePath}`);
                  // Refresh list
                  document.getElementById("list").click();
                } catch (err) {
                  log("Error removing:", err);
                  alert("Error removing NFT: " + err.message);
                }
              }
            });
          });

          statusEl.textContent = `Listed ${jsonFiles.length} NFTs.`;
          statusEl.className = "small success";
        } catch (err) {
          console.error(err);
          statusEl.textContent = "Error listing NFTs: " + (err.message || err);
          statusEl.className = "small error";
          log("ERROR:", err);
        }
      });
      async function createFileOnGithub({
        token,
        owner,
        repo,
        branch = "main",
        path,
        contentBase64,
        message,
      }) {
        const url = `https://api.github.com/repos/${encodeURIComponent(
          owner
        )}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(path)}`;
        const body = {
          message: message || `Add ${path}`,
          content: contentBase64,
          branch: branch,
        };
        const res = await fetch(url, {
          method: "PUT",
          headers: {
            Authorization: "token " + token,
            Accept: "application/vnd.github+json",
            "X-GitHub-Api-Version": "2022-11-28",
            "Content-Type": "application/json",
          },
          body: JSON.stringify(body),
        });

        const j = await res.json();
        if (!res.ok) {
          // helpful error message
          let msg = `GitHub API error ${res.status}`;
          if (j && j.message) msg += ": " + j.message;
          throw new Error(
            msg + (j && j.errors ? "\\n" + JSON.stringify(j.errors) : "")
          );
        }
        log("Create file response:", j.content && j.content.path);
        return j;
      }

      async function deleteFileOnGithub({
        token,
        owner,
        repo,
        branch = "main",
        path,
        sha,
        message,
      }) {
        const url = `https://api.github.com/repos/${encodeURIComponent(
          owner
        )}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(path)}`;
        const body = {
          message: message || `Delete ${path}`,
          sha: sha,
          branch: branch,
        };
        const res = await fetch(url, {
          method: "DELETE",
          headers: {
            Authorization: "token " + token,
            Accept: "application/vnd.github+json",
            "X-GitHub-Api-Version": "2022-11-28",
            "Content-Type": "application/json",
          },
          body: JSON.stringify(body),
        });

        const j = await res.json();
        if (!res.ok) {
          let msg = `GitHub API error ${res.status}`;
          if (j && j.message) msg += ": " + j.message;
          throw new Error(
            msg + (j && j.errors ? "\\n" + JSON.stringify(j.errors) : "")
          );
        }
        log("Delete file response:", j.commit && j.commit.sha);
        return j;
      }

      // quick demo draw on load
      drawNFT("Demo NFT");

      // Tab switching
      document.querySelectorAll(".tab-button").forEach((button) => {
        button.addEventListener("click", () => {
          // Remove active class from all buttons and content
          document
            .querySelectorAll(".tab-button")
            .forEach((btn) => btn.classList.remove("active"));
          document
            .querySelectorAll(".tab-content")
            .forEach((content) => content.classList.remove("active"));

          // Add active class to clicked button and corresponding content
          button.classList.add("active");
          const tabId = button.getAttribute("data-tab") + "-tab";
          document.getElementById(tabId).classList.add("active");
        });
      });
    </script>
  </body>
</html>
